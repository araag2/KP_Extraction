Algorithm for the classification of multi-modulating signals on the electrocardiogram
This article discusses the algorithm to measure electrocardiogram (ECG) and respiration simultaneously and to have the diagnostic potentiality for sleep apnoea from ECG recordings. The algorithm is composed by the combination with the three particular scale transform of aj(t), uj(t), oj(aj) and the statistical Fourier transform (SFT). Time and magnitude scale transforms of aj(t), uj(t) change the source into the periodic signal and τj = oj(aj) confines its harmonics into a few instantaneous components at τj being a common instant on two scales between t and τj. As a result, the multi-modulating source is decomposed by the SFT and is reconstructed into ECG, respiration and the other signals by inverse transform. The algorithm is expected to get the partial ventilation and the heart rate variability from scale transforms among aj(t), aj+1(t) and uj+1(t) joining with each modulation. The algorithm has a high potentiality of the clinical checkup for the diagnosis of sleep apnoea from ECG recordings.
Introduction
The electrocardiogram (ECG) contains well-known PQRST(U) pattern. Its morphology has been extensively studied since the technique of recording was introduced in the beginning of the twentieth century. The use of computers for ECG recording enabled studies of dynamic properties of the ECG. In particular, two important characteristics have been revealed: amplitude and frequency modulation.
The modulation of the cardiac cycle is extensively studied based on the signal that is generated from intervals between consecutives R-peaks, known as heart rate variability (HRV). Numerous approaches have been proposed and the signal have been decomposed in various ways—analyzing their spectral properties by frequency and time-frequency methods such as Fourier transform [2], autoregressive spectral estimation [11], wavelet transform [9, 17], or their scaling properties [6].
The amplitude characteristics and amplitude modulation received less attention, especially because the notion of the ECG amplitude is ambiguous: the heart as a source of the signal is moving and the signal is collected from the surface of the body that is moving as well. In addition, it is usually recorded as a 2-D projection. However, it has long been recognized that one of the sources of the amplitude modulation—the respiratory related movement of the thorax can be usefully used to extract the information about the respiration.
The influence of respiration on recording cardiac potentials was reported as early as in 1967; Flaherty et al. [5] and Moody et al. [13] were probably the first to discuss the possibility to derive the respiratory signal from the ECG. Since then several algorithms were proposed to reconstruct respiration by demodulating the ECG signal (e.g. [1, 4, 8, 10]).
The ECG-derived respiration signal either based on changes in heart rate or based on direct effect of respiration on the ECG waveform has been particularly used in studies of obstructive sleep apnoea [3, 16].
The problem to reconstruct waveform from the discrete Fourier analysis is that the biological signal has complicated properties; being non-stationary wave, including random noise and having interactive components. However, though people rarely notice, the essential problem is that there is no way to gather impartial and statistical samples. That is why samples from an unique sampling frequency are biased for spectral analysis even if fine sampling.
The purpose of this study is to introduce an algorithm to classify the multi-modulating waveforms on ECG signals. The algorithm is composed by the three particular scale transforms and the statistical Fourier transform (SFT) with impartial and statistical samples [12]. As a result, the multi-modulating source is decomposed by the SFT and is reconstructed into ECG, respiration and the other signals simultaneously by particular transformations.
Algorithm
The principle of this algorithm is the selection of three particular scale transforms. Two scales convert modulating waveforms into the periodic signal and the other converts the periodic components into a few terms. The role of the SFT is to hold sample information for any transforms.
Scale transforms aj(t), uj(t) and oj(t) on modulating signal
Since a source sample at any instant tk has the mutual phase relationship of instantaneous components on the SFT, any scale transform including permutation expresses the same sample as own instantaneous components by each scale (Appendix 1).
Three scale transforms aj(t), uj(t), oj(t) are adopted to the periodicity and to the reduction of Fourier components.
aj = aj(t) is a scale to match time intervals in the standard’s intervals and is called adaptive scale and uj = uj(τj) is a scale to match the magnitude spans in the standard’s magnitudes. Those scales convert the source x′(t) into the standard xj(t) as xj(t) = x′(aj)/uj(aj). aj(t) and uj(aj), then, are defined as a join of each akj(t) and ukj(akj) (k = 1,..., kj·) when the standard repeats kj times in a window Tj.
oj = oj(t), called inherent scale, is a timescale to convert the standard xj(t) into the Fourier series of rj components passing through 2rj poles of xj(t). The scale transform τj(t) is defined as the composite transform as follows (Appendix 2): 
The transformed signal (x′(τj) − εj(τj))/uj(τj) occupies rj instantaneous components of the skipped ikjth term in a window Tjincluding kj modulations. While, instantaneous components of the εj(τj)/uj(τj) scatters into broad components from the 1st to the nth terms. As a result, (x′(τj) − εj(τj))/uj(τj) fits the scales τj, uj and εj(τj)/uj(τj) unfits scales τj, uj, and then, the source x′(t) is decomposed into two class modulations of x′(τj) − εj(τj) and εj(τj) (Appendix 3).
That is, x′(τj) − εj(τj) is extracted by vj(τj) = Σuj(τj)hij(τj) from the ikjth (i = 1,.., rj) components and εj(τj) is extracted by the other εj(τj) = Σuj(τj)hij(τj) except the ikjth components when n instantaneous components of x′(τj)/uj(τj) are defined as hij(τj). The source x′(t), therefore, is decomposed into x′(t) − εj(t) and εj(t) by inverse scale transform t = t(τj) under an adequate uj(τj).
The magnitude scale ukj(τj) is defined as an expression of the magnitude pattern in each window Tkj when the signals vj(τj)(=x′(τj) − εj(τj)), εj(τj) and uj(τj) are expressed by {vkj(τj)}k, {εkj(τj)}k and {ukj(τj)}k (k = 1,.., kj), and each changes its waveform independently. Especially, vj(τj) is expressed by a constant value uj(τj) = ukj in each window Tkj when its magnitude modulation takes a similar figure with the standard (Appendix 4).
Iterative scale classification of modulating signals
The timescale transform of the residual εj(t) is defined as τj+1(t) = oj+1(aj+1(t)) when several waves of {εkj(t)/ukj+1(t)}k in εj(t)/uj+1(t) reappears within a window Tj+1(Tj+1 ≤ Tj). εj(t) is analyzed as the j + 1th modulation with the iterative algorithm as εj(t) − εj+1(t) and εj+1(t) under aj+1(t), oj+1(aj+1(t)), uj+1(t) and xj+1(t) (Appendix 2).
When x′(t) is m classes of Fourier series with terms of r1, r2,..., rm (n = r1 + r2 + 
 + rm), it expresses Eq. 2. 
In Eq. 2, t = t(τj) is the inverse scale transform of the jth scale τj to scale t, vj(t) is a Fourier series of the jth class modulation, and εm(t) is the mth residual signal. Equation 2 shows that x′(t) is reconstructed completely by periodic Fourier series vj(τj) on scale τj (j = 1,2,..., m).
Quantity of information on the modulating signal
The relation between the quantity of information (3) and the modulation (4) is derived from formula (2).
Since the probability of components on the jth class modulation is to be pj = rj/n, the probability to encounter x′(t) with m modulations is p(r1,r2,..., rm) = p1r1, p2r2,..., pmrm which relates to the geometrical mean 
. Equation is as follows (Appendix 5). 
It clearly shows that the quantity of information on multi-modulating signal is m itself.
When hij(τj) is the ith instantaneous Fourier component of standard xj(τj) in scale τj and hij(t) is its modulating component in scale t, the morphological relation is given by the following Formula (4): 
In Eq. 4, ∂τj/∂t is the Jacobian. Therefore, formula (4) shows that the modulation of every component at scale t is expressed by scale’s modulations on its magnitude uj(τj) and its time τj(t) = oj(a(t)). Especially, the adaptive scale aj(t) describes composite transform aj(t) = c1(c2(
cn(t))) and that of exchanged orders aj(t) = cn(
c2 (c1 (t))), so the sth scale cs(t) will express its specific modulation from the standard such as modulations of PQ, QRS, QT and RR.
Materials and methods
The analysis of scale classification of the three modulating signals on V4 lead was carried out by using the statistical Fourier analysis with maximum terms of 256 with A/D converted 16-bit samples of the sampling frequency 20 kHz over successive 50 s. To gather independent samples with 256 terms, samples needed to be accumulated by the high speed 20 kHz of A/D converter with a large dynamic range of 16 bit to avoid the deform of a tiny respiratory signal (Fig. 1).
Fig. 1Synchronous frequency samplings on scale t and τ
The ECG standard xj(t) was selected from the source x′(t) without breathing. On the other hand, x′(t) with natural breathing and the respiratory flow  are recorded simultaneously by using Number 3 Fleisch pneumotachograph. Both the ECG and the respiratory scale transforms were the same as in Fig. 2a, b of Appendix 2. The ECG x′(t) − εj(t) and its baseline wander εj(t) were analyzed when uj(τj) = 1 and the respiratory standard xj+1(t) was selected from stationary sequences of εj(t) in 16 respiratory cycle. (εj(τj+1) − εj+1(τj+1))/uj+1(τj+1) and εj+1(τj+1)/uj+1(τj+1) were analyzed when uj+1(τj) of the formula (5) in Appendix 4 and lung ventilation Vj+1(t) and its residual εj+1(t) were determined.
Fig. 2ECG and respiratory standard waves and specific points on scale t. a Cardiac standard, b respiratory standard, and c detecting dots on a part of the source
Results
Signals corresponding to every process on the scale classification of m = 2 under constant magnitude scale of uj = 1 are illustrated in Fig. 3 with five cardiac periods. That is, intervals among specific points in source x′(t) in Fig. 3a are transformed into the same intervals of the standard signal with the adaptive scale aj(t) to x′(aj(t)) of Fig. 3b and with the inherent scale τj(t) to x′(oj(aj(t))) of Fig. 3c. The transformed signal x′(τj) is decomposed into statistical Fourier components on a fundamental period of 53 cardiac intervals. The transformed signal xj′(τj) in Fig. 3d is a reconstructed signal from the 53rd, 106th, 159th and 212th components, and its residual εj(τj) in Fig. 3e from all other components. The extracted ECG xj′(t) in Fig. 3f and the base line wander εj(t) in Fig. 3g are the inverse scale-transformed signals from scale τj to scale t. When tiny-leak signals on the εj(t) synchronized with intervals of QT are replaced with linear trends, the figure of pattern εj(t) takes that of the lung ventilation in Fig. 3i. The smoothing signal, Vj(t) in Fig. 3h is a filtered signal of εj(t) with low-pass filter (LPF) under 30 terms (0.6 Hz). Vj(t) is illustrated with enlarged four times. The signal V(t) in Fig. 3i is the lung ventilation curve which is an integral signal of the direct measurement of the respiratory flow Fig. 3Classified process of modulating signal of the algorithm
Any differences of P ∼ U waveforms between the source x′(t) and reconstructed ECG x′j(t) bear getting information, and also the differences between ventilation V(t) and baseline wander Vj(t) are small when frequencies lower than breathing are neglected. x′j(t) provides time-interval information on Minnesota codes better than that of x′(t) clearly in visual.
Correlation coefficients ρ between the signal Vj(t) and V(t) are calculated by each ventilation with scatter plots in Fig. 4a, and are classified by P ∼ U waves of 53 cardiac signals in Table 1a and by respiratory phases of 16 ventilations in Table 1b. Total ρ takes even values (ρ ≈ 0.82) and has less interference between P ∼ U waves in cardiac cycles. However, it takes low values (ρ ≤ 0.5) at the transient regions of I, III between the inspiration and the expiration corresponding to loops in Fig. 4a. The inspiration and the expiration except transient regions are statistically dominant at higher value (ρ ≈ 0.95). It is clear that the scale classification extracts the electrical activity of the heart with constant magnitude scale of uj(τj) = 1 in hole window of Tj. The extracted baseline wander is constructed with lung ventilation and other biological information.
Fig. 4X–Y loop among modulating Vj(t), Vj+1(t) and V(t)Table 1Correlation coefficients ρi among Vj(t), Vj+1(t) and V(t) on cardiac and respiratory stagesCardiac stagesPQQRSST-TBase lineTotal(a) Correlation coefficients ρi between Vj(t) and V(t) on ECG stages ρi0.83280.82430.81490.81510.8244 Number of samples13,56612,69033,01843,553102,827Respiratory stagesI II III VI V Total(b) Correlation coefficients ρi between Vj(t) and V(t) on respiratory stages ρi0.39900.97880.57720.99700.95460.7273 Number of samples25,74725,21025,92814,57411,558103,017(c) Correlation coefficients ρi between Vj+1(t) and V(t) on respiratory stages ρi0.99230.65890.99430.80320.73050.91648 Number of samples25,28622,81621,16315,15518,077102,497I inspirations before midpoints, II inspirations after midpoints, III expirations before midpoints, VI expirations after midpoints, V expirations after inflection points
The magnitude scale transform is applied to the scale classification of the base line wander Vj(t) with a respiratory standard in Fig. 2b. Scale classification of m = 4 is illustrated in Fig. 5, the source x′(t) in Fig. 5a, the extracted ECG xj(t) in Fig. 5b, the extracted respiratory signal Vj+1(t) in Fig. 5c, the residual εj+1(t) in Fig. 5d, the leak ECG ε(t) over 0.6 Hz of εj(t) in Fig. 5e and the ECG of xj(t) + ε(t) in Fig. 5f. The signal V(t) in Fig. 5g is 16 measured respiratory ventilations. The magnitude scale Δuj+1(t) is illustrated in Fig. 5h.Vj+1(t) and εj+1(t) are displayed in the reverse because the extracted respiratory waveform is a visually reversed V(t). εj+1(t) is similar to base-line trends of V(t) which relate to the thoracic gas volume (TGV).
Fig. 5Scale classification of the four modulating signals in an electro-cardiac signal
The scatter plots of 15 lung ventilations between Vj+1(t) and V(t) take the similar pattern as illustrated in Fig. 4b. Correlation coefficients ρ in Table 1c takes higher value than the others though transient regions change I, III into II, IV.
The frequency distributions of the amplitude components on |V(f)|, |Vj+1(f)|, |εj+1(f)| and that of phase shifts Δφ(f) between V(f) and Vj+1(f) are illustrated in Fig. 6. On frequency ranges from 0.2 to 0.5 Hz, amplitude distribution in |V(f)| and |Vj+1(f)| takes similar pattern and those of phase shifts are invariant near 0°. Amplitude distribution in |εj+1(f)| has not only the lower frequency components under 0.06 Hz corresponding to the trends of TGV but also the leak components of the lung ventilation from 0.25 to 0.5 Hz. The components of |εj+1(f)|, moreover, has the harmonics among 0.04, 0.1, 0.18 and 0.28 Hz though those harmonics disappear in |V(f)| and |Vj+1(f)| at least.
Fig. 6Frequency distributions of the measured V(f) and the extracted Vj+1(f), εj+1(f)
As a result, the time and magnitude scale is effective to classify modulating signals from the higher frequency Vj+1(t) to the lower frequency εj+1(t) because a residual εj+1(t) has less interference of the higher Vj+1(t) and successive sequential εj+1(t) will supply the signal for detecting other lower modulation.
Discussion and conclusion
A discrepancy between time domain and frequency domain analysis happens commonly by using biased samplings for discrete signal processing in various way such as Hilbert transform [2] and wavelet analysis [9] relating with an unique sampling frequency. Moreover, the mathematical concepts of one-to-one correspondence, n unknown amplitudes and phases are derived from 2n samples, hinders to orientate the statistics in the signal processing.
The SFT, however, has no contradiction between Fourier analysis and the statistics which resolute components with the same signal-to-nose ratio (SNR) for any signal decreasing amplitude components with order 1/f such as ECG signal, which is unsatisfied in the autoregressive spectral estimation [11]. The SFT component, moreover, is given independently by a time trace of instantaneous components at each instant as shown in Appendix 1. That is, its amplitude and phase are not calculated by the inner products between the source and trigonometric bases but by the extracted traces of instantaneous sin-wave themselves [12]. The concepts of signal arrangements at series {tk} is another thing on the SFT because the replacement between ti and tj needs the replacements of all the synchronous frequency samplings between ti and tjto hold the same instantaneous components. The summation of replacements, then, is about 
. In other words, the SFT supplies a signal ensemble arranging samples of the series {tk}. In this study, discrete samples from A/D converter of 20 kHz satisfy the independency as shown in Appendix 6. As a result, the random noise including a signal is not analyzed as a white noise but as inherent components characterizing arrangements. Therefore, the reconstructed waveform of a baseline wander holds a prototype even if it includes many random noises.
The necessary condition of the spectral analysis known as Nyquist’s condition [14, 15] becomes precise on the SFT as shown in Appendix 3, which confirms its condition statistically. The potentiality to scatter the aliased components impartially discriminates the waveforms under the unsatisfied Nyquist’s condition. In this algorithm, while the inherent scale transform converges to the standard xj(τj) with four skipping components, others εj(τj), either continuous or random, disperse components into 256 terms.
Since the scale-transformed samples on the SFT are gathered from a whole window at any instant, those samples reflect its scale transform better than any local one. The random and leak signal on the extracted ECG xj′(t) are reduced into the tiny level under a stable behavior of the random noise. The 256 terms is enough to analyze scale-transformed signal in a window under 53 cardiac cycles because transformed components with the ranges, 8 ≤ kj ≤ 53, takes almost the same figures. The high-resolution analysis, therefore, is accomplished by the relative high SNR from those instantaneous components.
The problem on the scale transforms is to be adequate scales, not to be expressing the true biological modulation. aj+1(t) is, however, selected a traditional scale for non-stationary sequences in each respiratory cycle which carry information stored in Fourier phases as already indicated in [6] and aj(t) is selected from cardiac cycles without breathing in addition to the non-stationary sequences. As a result, oj(aj) and oj+1(aj+1) make those mutual relationship of phases more simple relations. Taking own standard characterized with number of poles is also reasonable to determine the waveform reconstruction and to discriminate the own HRV. Moreover, the lost waveform is scattered into the other components without losing the morphologic information such as the leak ECG waveform.
It is well known the volume conductivity of the thorax takes inequality and changes the electro cardiac potentials on the thorax’s surface with respiratory movements [1, 5].
In the scale classification of m = 4, it indicates that a constant magnitude scale ukj = 1 produces unchangeable heart-activity xj′(t) so that the signal εj(t) appears in respiratory modulations from their changes of the conductivity. It suggests that the standard without breathing follows the formula (2) of the signal classification and the source follows the formula (4) which expresses the modulating standard with Jacobian, ∂τj/∂t. A composite scale cs(t), therefore, is expected to express the inherent modulation from the standard such as PQ, QT and RR. That is, the spectral analysis of cs(t) on RR provides the distribution of the HRV without a tachogram which is expressed in other ways by others [2, 9, 11]. The extracted ECG has the potentiality to detect R–R modulations of the heart itself.
The algorithm extracts the lung ventilation curves {Vj+1(t)}k from V4 lead as changing the thoracic gas volume [1, 4]. The difference of amplitude distribution between V(t) and Vj+1(t) from spectral analysis takes the same pattern around 0.3 Hz [8]. The phase difference between V(t) and Vj+1(t), however, occurs in the transient regions between the inspiration and the expiration which deduce from inadequate respiratory standards, false respiratory peaks and the gas compression in the thorax [7]. It is effective to determine specific components, such as harmonics of εj+1(t) around (0.04, 0.1, 0.18 and 0.28 Hz) in cardiovascular responses [2, 17].
Information of the partial ventilation is also expected from other 12 leads [8]. The respiratory Jacobian ∂τj+1/∂t, like that of ECG, has the potentiality to detect respiratory modulation itself as a part of the HRV and uj+1(t) is expected to detect the amplitude modulation such as sighs distribution. The residual εj+1(t) supplies information of waveforms not only of the thoracic gas volume but also of the blood flow relating to cardiovascular responses [2, 11, 17].
It can be concluded that this algorithm reveals the simultaneous measurements of ECG and respiration. The comparison with the frequency distribution and the waveform evaluates new modulations clearly, such as ukj+1 for detecting changes of the tidal volume (TV) and for finding TGV and cardiovascular responses. This contribution of the algorithm indicates diagnostic potentials on the sleep apnoea from ECG recordings [16].